---
description: Address all review feedback on a GitHub pull request
---

Analyze all review comments on a GitHub PR and implement requested changes with individual commits for each piece of feedback.

[Extended thinking: This command fetches all review comments from a PR, categorizes them, implements the requested changes one by one, creates focused commits for each change, and posts auto-replies to notify reviewers.]

**PR Review Comments Handler**

## Usage Examples:

1. **Address all comments on a PR**:
   `/address-pr-review-comments 6956`

2. **Address only unresolved comments**:
   `/address-pr-review-comments 6956 unresolved`

3. **Address comments from specific reviewer**:
   `/address-pr-review-comments 6956 celebdor`

## Implementation Details:

- Uses `gh api` to fetch PR review comments via GitHub REST API
- Parses both inline code comments and general PR discussion comments
- Categorizes comments into actionable vs informational
- Creates individual commits for each distinct piece of feedback
- Posts auto-replies to comments when addressed (prefixed with [AUTOGENERATED AI RESPONSE])

## Process Flow:

1. **Fetch All Comments**:
   - Use gh api to get review comments, review threads, and issue comments
   - Parse JSON responses to extract:
     - Comment ID and URL
     - Author name and email
     - File path and line number (for inline comments)
     - Comment body text
     - Resolution status

2. **Categorize Comments**:
   - Actionable: Requests for code changes, additions, fixes
   - Questions: Need user clarification
   - Informational: Acknowledgments, already resolved
   - Filter based on $2 argument if provided

3. **Create Todo List**:
   - One todo item per actionable comment
   - Format: "Address @{reviewer} feedback on {file}:{line} - {summary}"
   - Display to user for confirmation

4. **Iterative Implementation**:
   For each actionable comment:
   - Mark todo as in_progress
   - Analyze what change is requested
   - Search and read relevant code using Grep/Read tools
   - Implement the requested changes using Edit tool
   - Run `make lint-fix` to fix imports and formatting
   - Create focused commit with conventional commits format:
     ```
     fix(review): Address @{reviewer} feedback on {component}

     Review comment: "{quote}"

     Changes made:
     - {change 1}
     - {change 2}

     Addresses: {comment_url}

     Co-authored-by: {Reviewer Name} <{email}>
     ```
   - Post auto-reply to the comment:
     ```
     [AUTOGENERATED AI RESPONSE]

     This feedback has been addressed in commit {hash}.

     Changes made:
     - {change 1}
     - {change 2}

     Please review and let me know if further changes are needed.
     ```
   - Mark todo as completed
   - Move to next comment

5. **Verification**:
   - After all comments addressed, run `make pre-commit`
   - Fix any issues that arise
   - Do not proceed until all checks pass

6. **Push Changes**:
   - Push all commits to PR branch
   - Confirm successful push

7. **Summary Report**:
   - Display total comments processed
   - List all commits created
   - Provide link to PR

## Special Handling:

- **Grouped comments**: If multiple comments on same code, may combine into single commit
- **Conflicting feedback**: Ask user for direction
- **Unclear comments**: Pause and ask user for clarification
- **Already addressed**: Skip and note in summary
- **Questions**: Pause and get user input before proceeding
- **Large refactors**: Ask user if should be single commit or broken down
- **Test failures**: Fix before proceeding, ask for help if stuck

## Arguments:
- $1: PR number or GitHub PR URL (required)
- $2: Filter - "all" (default), "unresolved", or specific reviewer username (optional)

## Auto-reply Format:

All auto-replies to PR comments will be prefixed with:
`[AUTOGENERATED AI RESPONSE]`

This ensures transparency that responses are from an AI bot, not directly from the user.

## Notes:

- Each commit should be atomic and focused on addressing specific feedback
- Reviewer attribution via Co-authored-by honors their contributions
- Auto-replies provide traceability from comment to commit
